<div class="row">
  <div class="col-md-12">
    <h1 class="mb-4">Manage Users</h1>

    <div class="table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Joined</th>
            <th>Products</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% @users.each do |user| %>
            <tr>
              <td><%= user.name %></td>
              <td><%= user.email %></td>
              <td>
                <div class="dropdown">
                  <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                    <%= user.role.titleize %>
                  </button>
                  <ul class="dropdown-menu">
                    <% User.roles.keys.each do |role| %>
                      <li>
                        <%= link_to role.titleize,
                            toggle_role_admin_user_path(user, role: role),
                            class: "dropdown-item #{'active' if user.role == role}",
                            data: { turbo_method: :patch } %>
                      </li>
                    <% end %>
                  </ul>
                </div>
              </td>
              <td><%= time_ago_in_words(user.created_at) %> ago</td>
              <td><%= user.products.count %></td>
              <td>
                <%= link_to "View", admin_user_path(user), class: "btn btn-sm btn-primary" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
