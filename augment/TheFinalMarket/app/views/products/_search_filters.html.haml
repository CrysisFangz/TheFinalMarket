.search-filters.bg-white.p-4.rounded-lg.shadow.mb-6
  = form_with(url: products_path, method: :get, data: { turbo_frame: "products_list" }) do |f|
    .grid.grid-cols-1.md:grid-cols-2.lg:grid-cols-3.gap-4
      .field
        = f.label :query, "Search", class: "block text-sm font-medium text-gray-700 mb-1"
        = f.text_field :query, value: @search_params[:query], 
            class: "input-field w-full",
            placeholder: "Search products..."

      .field
        = f.label :category_id, "Category", class: "block text-sm font-medium text-gray-700 mb-1"
        = f.select :category_id, 
            options_from_collection_for_select(@categories, :id, :name, @search_params[:category_id]),
            { include_blank: "All Categories" },
            class: "input-field w-full"

      .field
        = f.label :tag_ids, "Tags", class: "block text-sm font-medium text-gray-700 mb-1"
        = f.select :tag_ids,
            options_from_collection_for_select(@tags, :id, :name, @search_params[:tag_ids]),
            { include_blank: "Select Tags" },
            { multiple: true, class: "input-field w-full" }

    .grid.grid-cols-1.md:grid-cols-2.lg:grid-cols-4.gap-4.mt-4
      .field
        = f.label :min_price, "Min Price", class: "block text-sm font-medium text-gray-700 mb-1"
        = f.number_field :min_price, value: @search_params[:min_price],
            class: "input-field w-full",
            min: 0,
            step: 0.01

      .field
        = f.label :max_price, "Max Price", class: "block text-sm font-medium text-gray-700 mb-1"
        = f.number_field :max_price, value: @search_params[:max_price],
            class: "input-field w-full",
            min: 0,
            step: 0.01

      .field
        = f.label :min_rating, "Min Rating", class: "block text-sm font-medium text-gray-700 mb-1"
        = f.select :min_rating,
            options_for_select((1..5).map { |n| [pluralize(n, "star"), n] }, @search_params[:min_rating]),
            { include_blank: "Any Rating" },
            class: "input-field w-full"

      .field
        = f.label :sort_by, "Sort By", class: "block text-sm font-medium text-gray-700 mb-1"
        = f.select :sort_by,
            options_for_select(
              [
                ["Newest", "newest"],
                ["Price: Low to High", "price_asc"],
                ["Price: High to Low", "price_desc"],
                ["Rating", "rating"],
                ["Popularity", "popularity"]
              ],
              @search_params[:sort_by]
            ),
            { include_blank: "Relevance" },
            class: "input-field w-full"

    .flex.items-center.gap-4.mt-4
      .field.flex.items-center
        = f.check_box :in_stock, checked: @search_params[:in_stock], class: "form-checkbox"
        = f.label :in_stock, "In Stock Only", class: "ml-2 text-sm text-gray-700"

      .flex-grow.text-right
        = f.submit "Apply Filters", class: "btn btn-primary"
        = link_to "Clear Filters", products_path, class: "btn btn-secondary ml-2"