<%# app/views/seller/dashboard/index.html.erb %>

<div class="min-h-screen bg-gradient-to-br from-spirit-light to-white">
  <%# Spirit orbs decoration %>
  <div class="spirit-orb spirit-orb-top-right opacity-20"></div>
  <div class="spirit-orb spirit-orb-bottom-left opacity-20"></div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <%# Header %>
    <div class="flex items-center justify-between mb-8">
      <div>
        <h1 class="text-3xl font-bold bg-gradient-to-r from-spirit-primary to-spirit-secondary bg-clip-text text-transparent">
          Seller Dashboard
        </h1>
        <p class="text-spirit-dark mt-2">Welcome back, <%= current_user.name %></p>
      </div>
      
      <div class="flex space-x-4">
        <%= link_to new_seller_product_path, 
            class: "spirit-button flex items-center space-x-2",
            data: { turbo_frame: "new_product" } do %>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
          </svg>
          <span>Add Product</span>
        <% end %>
      </div>
    </div>

    <%# Stats Grid %>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <%# Monthly Revenue %>
      <div class="spirit-card relative overflow-hidden group">
        <div class="absolute inset-0 spirit-gradient opacity-5 group-hover:opacity-10 transition-opacity"></div>
        <div class="relative z-10">
          <div class="flex items-center justify-between">
            <h3 class="text-spirit-dark font-medium">Monthly Revenue</h3>
            <div class="text-spirit-primary">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </div>
          </div>
          <p class="mt-2 text-2xl font-bold text-spirit-dark">
            <%= number_to_currency(@monthly_revenue) %>
          </p>
        </div>
      </div>

      <%# Pending Orders %>
      <div class="spirit-card relative overflow-hidden group">
        <div class="absolute inset-0 spirit-gradient opacity-5 group-hover:opacity-10 transition-opacity"></div>
        <div class="relative z-10">
          <div class="flex items-center justify-between">
            <h3 class="text-spirit-dark font-medium">Pending Orders</h3>
            <div class="text-spirit-primary">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
              </svg>
            </div>
          </div>
          <p class="mt-2 text-2xl font-bold text-spirit-dark">
            <%= @pending_orders_count %>
          </p>
        </div>
      </div>

      <%# Low Stock Alert %>
      <div class="spirit-card relative overflow-hidden group">
        <div class="absolute inset-0 spirit-gradient opacity-5 group-hover:opacity-10 transition-opacity"></div>
        <div class="relative z-10">
          <div class="flex items-center justify-between">
            <h3 class="text-spirit-dark font-medium">Low Stock Items</h3>
            <div class="text-spirit-primary">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
              </svg>
            </div>
          </div>
          <p class="mt-2 text-2xl font-bold text-spirit-dark">
            <%= @low_stock_products.count %>
          </p>
        </div>
      </div>

      <%# Customer Satisfaction %>
      <div class="spirit-card relative overflow-hidden group">
        <div class="absolute inset-0 spirit-gradient opacity-5 group-hover:opacity-10 transition-opacity"></div>
        <div class="relative z-10">
          <div class="flex items-center justify-between">
            <h3 class="text-spirit-dark font-medium">Rating</h3>
            <div class="text-spirit-primary">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
              </svg>
            </div>
          </div>
          <p class="mt-2 text-2xl font-bold text-spirit-dark">
            4.8/5.0
          </p>
        </div>
      </div>
    </div>

    <%# Recent Orders and Top Products %>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <%# Recent Orders %>
      <div class="spirit-card">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-spirit-dark">Recent Orders</h3>
          <%= link_to "View all", seller_orders_path, class: "text-spirit-primary hover:text-spirit-secondary" %>
        </div>
        
        <div class="divide-y divide-spirit-light">
          <% @recent_orders.each do |order| %>
            <%= link_to seller_order_path(order), class: "block py-4 hover:bg-spirit-light/30 transition-colors" do %>
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium text-spirit-dark">#<%= order.number %></p>
                  <p class="text-sm text-spirit-dark/70"><%= order.created_at.strftime("%B %d, %Y") %></p>
                </div>
                <div class="text-right">
                  <p class="font-medium text-spirit-dark"><%= number_to_currency(order.total) %></p>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-spirit-light text-spirit-primary">
                    <%= order.status.titleize %>
                  </span>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>

      <%# Top Products %>
      <div class="spirit-card">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-spirit-dark">Top Products</h3>
          <%= link_to "View all", seller_products_path, class: "text-spirit-primary hover:text-spirit-secondary" %>
        </div>
        
        <div class="divide-y divide-spirit-light">
          <% @top_products.each do |product| %>
            <%= link_to seller_product_path(product), class: "block py-4 hover:bg-spirit-light/30 transition-colors" do %>
              <div class="flex items-center space-x-4">
                <%= image_tag product.image.variant(resize_to_fill: [48, 48]), 
                    class: "w-12 h-12 rounded-lg object-cover" %>
                <div class="flex-1">
                  <p class="font-medium text-spirit-dark"><%= product.name %></p>
                  <p class="text-sm text-spirit-dark/70"><%= pluralize(product.total_sales, 'sale') %></p>
                </div>
                <div class="text-right">
                  <p class="font-medium text-spirit-dark"><%= number_to_currency(product.price) %></p>
                  <p class="text-sm text-spirit-dark/70"><%= pluralize(product.stock, 'in stock') %></p>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<%# Turbo Frame for New Product Modal %>
<%= turbo_frame_tag "new_product" %>